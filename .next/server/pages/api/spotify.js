"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/spotify";
exports.ids = ["pages/api/spotify"];
exports.modules = {

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "(api)/./pages/api/spotify.js":
/*!******************************!*\
  !*** ./pages/api/spotify.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   \"getNowPlaying\": () => (/* binding */ getNowPlaying)\n/* harmony export */ });\n/* harmony import */ var querystring__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! querystring */ \"querystring\");\n/* harmony import */ var querystring__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(querystring__WEBPACK_IMPORTED_MODULE_0__);\n\nconst { SPOTIFY_CLIENT_ID: client_id , SPOTIFY_CLIENT_SECRET: client_secret , SPOTIFY_REFRESH_TOKEN: refresh_token ,  } = process.env;\nconst basic = Buffer.from(`${client_id}:${client_secret}`).toString(\"base64\");\nconst NOW_PLAYING_ENDPOINT = `https://api.spotify.com/v1/me/player/currently-playing`;\nconst TOKEN_ENDPOINT = `https://accounts.spotify.com/api/token`;\nconst getAccessToken = async ()=>{\n    const response = await fetch(TOKEN_ENDPOINT, {\n        method: \"POST\",\n        headers: {\n            Authorization: `Basic ${basic}`,\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        body: querystring__WEBPACK_IMPORTED_MODULE_0___default().stringify({\n            grant_type: \"refresh_token\",\n            refresh_token\n        })\n    });\n    return response.json();\n};\nconst getNowPlaying = async ()=>{\n    const { access_token  } = await getAccessToken();\n    return fetch(NOW_PLAYING_ENDPOINT, {\n        headers: {\n            Authorization: `Bearer ${access_token}`\n        }\n    });\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (_, res)=>{\n    const response = await getNowPlaying();\n    if (response.status === 204 || response.status > 400) {\n        return res.status(200).json({\n            isPlaying: false\n        });\n    }\n    const song = await response.json();\n    const isPlaying = song.is_playing;\n    const title = song.item.name;\n    const artist = song.item.artists.map((_artist)=>_artist.name).join(\", \");\n    const album = song.item.album.name;\n    const albumImageUrl = song.item.album.images[0].url;\n    const songUrl = song.item.external_urls.spotify;\n    return res.status(200).json({\n        album,\n        albumImageUrl,\n        artist,\n        isPlaying,\n        songUrl,\n        title\n    });\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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b3VyY2VzIjpbIndlYnBhY2s6Ly9yYXphbmZhd3dhei13ZWIvLi9wYWdlcy9hcGkvc3BvdGlmeS5qcz84NTExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBxdWVyeXN0cmluZyBmcm9tIFwicXVlcnlzdHJpbmdcIjtcblxuY29uc3Qge1xuICBTUE9USUZZX0NMSUVOVF9JRDogY2xpZW50X2lkLFxuICBTUE9USUZZX0NMSUVOVF9TRUNSRVQ6IGNsaWVudF9zZWNyZXQsXG4gIFNQT1RJRllfUkVGUkVTSF9UT0tFTjogcmVmcmVzaF90b2tlbixcbn0gPSBwcm9jZXNzLmVudjtcblxuY29uc3QgYmFzaWMgPSBCdWZmZXIuZnJvbShgJHtjbGllbnRfaWR9OiR7Y2xpZW50X3NlY3JldH1gKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbmNvbnN0IE5PV19QTEFZSU5HX0VORFBPSU5UID0gYGh0dHBzOi8vYXBpLnNwb3RpZnkuY29tL3YxL21lL3BsYXllci9jdXJyZW50bHktcGxheWluZ2A7XG5jb25zdCBUT0tFTl9FTkRQT0lOVCA9IGBodHRwczovL2FjY291bnRzLnNwb3RpZnkuY29tL2FwaS90b2tlbmA7XG5cbmNvbnN0IGdldEFjY2Vzc1Rva2VuID0gYXN5bmMgKCkgPT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFRPS0VOX0VORFBPSU5ULCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBoZWFkZXJzOiB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtiYXNpY31gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixcbiAgICB9LFxuICAgIGJvZHk6IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeSh7XG4gICAgICBncmFudF90eXBlOiBcInJlZnJlc2hfdG9rZW5cIixcbiAgICAgIHJlZnJlc2hfdG9rZW4sXG4gICAgfSksXG4gIH0pO1xuXG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0Tm93UGxheWluZyA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgeyBhY2Nlc3NfdG9rZW4gfSA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7XG5cbiAgcmV0dXJuIGZldGNoKE5PV19QTEFZSU5HX0VORFBPSU5ULCB7XG4gICAgaGVhZGVyczoge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2FjY2Vzc190b2tlbn1gLFxuICAgIH0sXG4gIH0pO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKF8sIHJlcykgPT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldE5vd1BsYXlpbmcoKTtcblxuICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDQgfHwgcmVzcG9uc2Uuc3RhdHVzID4gNDAwKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgaXNQbGF5aW5nOiBmYWxzZSB9KTtcbiAgfVxuXG4gIGNvbnN0IHNvbmcgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gIGNvbnN0IGlzUGxheWluZyA9IHNvbmcuaXNfcGxheWluZztcbiAgY29uc3QgdGl0bGUgPSBzb25nLml0ZW0ubmFtZTtcbiAgY29uc3QgYXJ0aXN0ID0gc29uZy5pdGVtLmFydGlzdHMubWFwKChfYXJ0aXN0KSA9PiBfYXJ0aXN0Lm5hbWUpLmpvaW4oXCIsIFwiKTtcbiAgY29uc3QgYWxidW0gPSBzb25nLml0ZW0uYWxidW0ubmFtZTtcbiAgY29uc3QgYWxidW1JbWFnZVVybCA9IHNvbmcuaXRlbS5hbGJ1bS5pbWFnZXNbMF0udXJsO1xuICBjb25zdCBzb25nVXJsID0gc29uZy5pdGVtLmV4dGVybmFsX3VybHMuc3BvdGlmeTtcblxuICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgIGFsYnVtLFxuICAgIGFsYnVtSW1hZ2VVcmwsXG4gICAgYXJ0aXN0LFxuICAgIGlzUGxheWluZyxcbiAgICBzb25nVXJsLFxuICAgIHRpdGxlLFxuICB9KTtcbn07XG4iXSwibmFtZXMiOlsicXVlcnlzdHJpbmciLCJTUE9USUZZX0NMSUVOVF9JRCIsImNsaWVudF9pZCIsIlNQT1RJRllfQ0xJRU5UX1NFQ1JFVCIsImNsaWVudF9zZWNyZXQiLCJTUE9USUZZX1JFRlJFU0hfVE9LRU4iLCJyZWZyZXNoX3Rva2VuIiwicHJvY2VzcyIsImVudiIsImJhc2ljIiwiQnVmZmVyIiwiZnJvbSIsInRvU3RyaW5nIiwiTk9XX1BMQVlJTkdfRU5EUE9JTlQiLCJUT0tFTl9FTkRQT0lOVCIsImdldEFjY2Vzc1Rva2VuIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiYm9keSIsInN0cmluZ2lmeSIsImdyYW50X3R5cGUiLCJqc29uIiwiZ2V0Tm93UGxheWluZyIsImFjY2Vzc190b2tlbiIsIl8iLCJyZXMiLCJzdGF0dXMiLCJpc1BsYXlpbmciLCJzb25nIiwiaXNfcGxheWluZyIsInRpdGxlIiwiaXRlbSIsIm5hbWUiLCJhcnRpc3QiLCJhcnRpc3RzIiwibWFwIiwiX2FydGlzdCIsImpvaW4iLCJhbGJ1bSIsImFsYnVtSW1hZ2VVcmwiLCJpbWFnZXMiLCJ1cmwiLCJzb25nVXJsIiwiZXh0ZXJuYWxfdXJscyIsInNwb3RpZnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/spotify.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/spotify.js"));
module.exports = __webpack_exports__;

})();